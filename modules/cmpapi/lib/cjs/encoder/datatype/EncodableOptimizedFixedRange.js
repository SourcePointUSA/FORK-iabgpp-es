"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EncodableOptimizedFixedRange=void 0;const FixedBitfieldEncoder_js_1=require("./encoder/FixedBitfieldEncoder.js"),FixedIntegerEncoder_js_1=require("./encoder/FixedIntegerEncoder.js"),FixedIntegerRangeEncoder_js_1=require("./encoder/FixedIntegerRangeEncoder.js"),AbstractEncodableBitStringDataType_js_1=require("./AbstractEncodableBitStringDataType.js"),EncodableFixedIntegerRange_js_1=require("./EncodableFixedIntegerRange.js");class EncodableOptimizedFixedRange extends AbstractEncodableBitStringDataType_js_1.AbstractEncodableBitStringDataType{constructor(e){super(),this.setValue(e)}encode(){let e=this.value.length>0?this.value[this.value.length-1]:0,n=FixedIntegerRangeEncoder_js_1.FixedIntegerRangeEncoder.encode(this.value),t=e;if(n.length<=t)return FixedIntegerEncoder_js_1.FixedIntegerEncoder.encode(e,16)+"1"+n;{let n=[],r=0;for(let t=0;t<e;t++)t===this.value[r]-1?(n[t]=!0,r++):n[t]=!1;return FixedIntegerEncoder_js_1.FixedIntegerEncoder.encode(e,16)+"0"+FixedBitfieldEncoder_js_1.FixedBitfieldEncoder.encode(n,t)}}decode(e){if("1"===e.charAt(16))this.value=FixedIntegerRangeEncoder_js_1.FixedIntegerRangeEncoder.decode(e.substring(17));else{let n=[],t=FixedBitfieldEncoder_js_1.FixedBitfieldEncoder.decode(e.substring(17));for(let e=0;e<t.length;e++)!0===t[e]&&n.push(e+1);this.value=n}}substring(e,n){let t=FixedIntegerEncoder_js_1.FixedIntegerEncoder.decode(e.substring(n,n+16));return"1"===e.charAt(n+16)?e.substring(n,n+17)+new EncodableFixedIntegerRange_js_1.EncodableFixedIntegerRange([]).substring(e,n+17):e.substring(n,n+17+t)}getValue(){return[...super.getValue()]}setValue(e){super.setValue(Array.from(new Set(e)).sort(((e,n)=>e-n)))}}exports.EncodableOptimizedFixedRange=EncodableOptimizedFixedRange;